# Configuration file for tool rails_best_practices
# Note: Inside { } you can use "except_methods:" and "ignored_files:" to omit
# some checks.

# Equivalent to : --features --spec --without-color --exclude railroader/
features: true
spec: true
without_color: true
exclude: ["railroader/", "^,.*"]

AddModelVirtualAttributeCheck: { }
AlwaysAddDbIndexCheck: { }
CheckSaveReturnValueCheck: { }
DefaultScopeIsEvilCheck: { }
DryBundlerInCapistranoCheck: { }
HashSyntaxCheck: { }
IsolateSeedDataCheck: { }
KeepFindersOnTheirOwnModelCheck: { }
LawOfDemeterCheck: { }
#LongLineCheck: { max_line_length: 80 }
MoveCodeIntoControllerCheck: { }
MoveCodeIntoHelperCheck: { array_count: 3 }
MoveCodeIntoModelCheck: { use_count: 4 }
MoveFinderToNamedScopeCheck: { }
MoveModelLogicIntoModelCheck: { use_count: 20 }
NeedlessDeepNestingCheck: { nested_count: 2 }
NotRescueExceptionCheck: { }
NotUseDefaultRouteCheck: { }
NotUseTimeAgoInWordsCheck: { }
OveruseRouteCustomizationsCheck: { customize_count: 5 }
ProtectMassAssignmentCheck: { }
# RemoveEmptyHelpersCheck: { }
RemoveTabCheck: { }
RemoveTrailingWhitespaceCheck: { }
# Disabled: rails_best_practices uses static analysis and cannot detect:
# - Methods called via Rails callbacks (before_action, after_action, etc.)
# - Methods made available via helper_method declarations
# - Private methods called by other methods in the same class
# This results in 70+ false positives for legitimate callback and helper methods.
# Controllers use extensive callback chains for authentication, authorization,
# locale handling, and security checks - all flagged incorrectly as "unused".
# RemoveUnusedMethodsInControllersCheck: { }
# RemoveUnusedMethodsInHelpersCheck: { }
RemoveUnusedMethodsInModelsCheck: { except_methods: [
  'Criteria#to_h', # Used by tests
  'Criteria#must?', # Used in ERB template; doesn't notice.
  'Criteria#should?', # Used in ERB template; doesn't notice.
  'Criteria#met_justification_or_url_required?', # Used in ERB template
  'Criteria#keys',
  'Criteria#suggested?', # Used in ERB template; doesn't notice.
  'Project#created_since', # Scope called dynamically
  'Project#updated_since', # Scope called dynamically
  'Project#in_progress', # Scope used for search & in test, but tool misses it
  'Project#passing', # Scope used for search & in test, but tool misses it
  'Criterion#must?', # Used in ERB template; doesn't notice.
  'User#digest',
  'User#created_since', # Used by daily stamp (rake); doesn't notice
  'User#updated_since', # Used by daily stamp (rake); doesn't notice
  'Badge#reset_widths!' # Used in tests and after regenerating badge images
  ] }
ReplaceComplexCreationWithFactoryMethodCheck: { attribute_assignment_count: 3 }
# Disable false positive ReplaceInstanceVariableWithLocalVariableCheck for
# app layout headers and automation-enhanced partials.
# 1. Layout partials are special: _header.html.erb is an application-wide
#    layout that needs authentication state (@session_user_id) set by
#    ApplicationController's before_action :setup_authentication_state
# 2. This is standard Rails convention: Using instance variables for
#    application-wide state like authentication in layouts is the
#    expected Rails pattern
# 3. Passing locals would be worse: The alternative would require modifying
#    the layout render call and passing locals explicitly, which adds
#    complexity without any real benefit.
# The instance variable @session_user_id is first set in
# ApplicationController#setup_authentication_state
# and is always are available throughout the request lifecycle for all
# views and layouts unless specially disabled.
# 4. _status_chooser.html.erb: Uses optional @automated_fields and
#    @overridden_fields set by controller when automation runs. Uses
#    defined?() to check existence - standard Rails pattern for optional state.
ReplaceInstanceVariableWithLocalVariableCheck: {
  ignored_files: ['app/views/layouts/_header\.html\.erb',
                  'app/views/projects/_status_chooser\.html\.erb']
}
# RestrictAutoGeneratedRoutesCheck: { }
SimplifyRenderInControllersCheck: { }
SimplifyRenderInViewsCheck: { }
# UseBeforeFilterCheck: { customize_count: 2 }
UseModelAssociationCheck: { }
UseMultipartAlternativeAsContentTypeOfEmailCheck: { }
UseParenthesesInMethodDefCheck: { }
UseObserverCheck: { }
UseQueryAttributeCheck: { }
UseSayWithTimeInMigrationsCheck: { }
# UseScopeAccessCheck: { }
UseTurboSprocketsRails3Check: { }
